<html lang="en">

<head>
    <meta charset="UTF-8" name="viewport" content="width=device-width, initial-scale=0.35">
    <link rel="icon" type="image/x-icon" href="../assets/icon.png">
    <link rel="stylesheet" href="../assets/style_main.css">
    <script src="../assets/script_main.js"></script>
    <title>Extra</title>
</head>

<body>
    <header>
        <div onclick="gear_button_onclick()" class="side_menu_button"><img src="./../assets/icon_cog.png" alt=""></div>
        <div onclick="go_to('main/main.html')">Main Page</div>
        <div onclick="go_to('main/mechanics.html')">Mechanics</div>
        <div onclick="go_to('main/abilities.html')">Abilities</div>
        <div onclick="go_to('main/extra.html')">Extra</div>
    </header>
    <side_menu id="side_menu"></side_menu>
    <main>
        <h1 id="extra_content">EXTRA CONTENT</h1>
        <hr>
        <p>
            This page contains a lot of additional content revolving on playing the game.
        </p>
        <h1 id="search">SEARCH</h1>
        <hr>
        <p>
            Searching works by typing in text in each of the 4 different textareas.<br>
            The search engine will look and try to match with all the 4 different categories. (Name, Summary, Tags)<br>
            If any of the categories do not let the ability pass it will not be displayed.<br>
            You can write in multiple lines to widen the search and let it pass if there is a match with any of the
            lines.
        </p>
        <p>
            <b>Note:</b> An empty line matches with ALL text!
        </p>
        <table width="100%">
            <tr>
                <td width="33%">Name Search</td>
                <td width="33%">Summary Search</td>
                <td width="33%">Tags Search</td>
            </tr>
            <tr>
                <td><textarea id="NameSearch" rows="4" style="width: 90%;"></textarea></td>
                <td><textarea id="TypeSearch" rows="4" style="width: 90%;"></textarea></td>
                <td><textarea id="TagsSearch" rows="4" style="width: 90%;"></textarea></td>
            </tr>
        </table>
        <input type="button" value="Search" onclick="Search()" />
        <h2 id="extra_content_table">Extra Content Table</h2>
        <hr>
        <table id="table_extra" width="100%">
        </table>
    </main>
</body>

<script>
    extra_raw = `[{"link":"../extra/premade_armaments.html", "name":"Premade Armaments", "summary":"Simple premade Armaments for new Players.", "tags":"Help<br>Items, Armaments"},
        {"link":"../extra/items_and_costs.html", "name":"Items and Costs", "summary":"Hey kiddo, want to buy drugs?", "tags":"Help<br>Items"},
        {"link":"../extra/curios.html", "name":"Curios", "summary":"Quirky items which do things!!", "tags":"Base Rule<br>Magical Items"},
        {"link":"../extra/consumable_items.html", "name":"Consumable Items", "summary":"Scrolls, potions, bombs. You want it?<br>It's yours my friend, as long as you have enough C.", "tags":"Base Rule<br>Magical Items, Consumable Items, Potions, Scrolls"},
        {"link":"../extra/character_assembler.html", "name":"Character Assembler", "summary":"Make stat allocation a breeze!", "tags":"Help<br>Character Creation"},
        {"link":"../extra/digital_character_sheet.html", "name":"Digital Character Sheet", "summary":"1v1 me bruv!", "tags":"Help<br>Character Managment"},
        {"link":"../extra/guide_to_potions.html", "name":"Guide to Potions (TO BE MERGED)", "summary":"Everything to know about potions or something...", "tags":"Base Rule<br>Magical Items, Consumable Items, Item Creation, Potions"}]`
    extra = JSON.parse(extra_raw)
    //---------------------------------------------------------------------
    FirstCell = `<tr>
                <td width="25%">
                    Name
                </td>
                <td width="40%">
                    Summary
                </td>
                <td width="35%">
                    Tags
                </td>
            </tr>`
    AbilityToText = function(input) {
        output = '<tr><td><a href="'
        output += input.link
        output += '">'
        output += input.name
        output += '</a></td><td>'
        output += input.summary
        output += '</td><td>'
        output += input.tags
        output += '</td></tr>'
        return output
    }
    SearchCategory = function(ElementHTML, category) {
        result = FirstCell
        console.log(extra)
        category.forEach(v => {
            debounce_name = false
            debounce_type = false
            debounce_tags = false
            NameArray = NameSearch.value.split("\n")
            TypeArray = TypeSearch.value.split("\n")
            TagsArray = TagsSearch.value.split("\n")
            for (i = 0; i < NameArray.length; i++) {
                if (v.name.toLowerCase().includes(NameArray[i].toLowerCase())) debounce_name = true
            }
            for (i = 0; i < TypeArray.length; i++) {
                if (v.summary.toLowerCase().includes(TypeArray[i].toLowerCase())) debounce_type = true
            }
            for (i = 0; i < TagsArray.length; i++) {
                if (v.tags.toLowerCase().includes(TagsArray[i].toLowerCase())) debounce_tags = true
            }
            if (debounce_name && debounce_type && debounce_tags) {
                result += AbilityToText(v)
            }
        })
        ElementHTML.innerHTML = result
    }
    Search = function() {
        SearchCategory(table_extra, extra)
    }
    //---------------------------------------------------------------------
    Search()
</script>

</html>